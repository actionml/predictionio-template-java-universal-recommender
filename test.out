
Queries to illustrate many use cases on a small standard dataset and for an automated integration test.

WARNING: for this to produce the correct result you must:
  1. Import data with
     $ python examples/import_handmade.py --access_key <your-app-accesskey>
  2. Copy handmade-engine.json to engine.json.
  3. Run 'pio build', 'pio train', and 'pio deploy'
  4. The queries must be run the same day as the import was done because date filters are part of the test.
NOTE: due to available and expire dates you should never see the Iphone 5 or Iphone 6.

============ simple user recs ============

Recommendations for user: u1

Query:

{
    "user": "u1"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:30.845-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for user: U 2

Query:

{
    "user": "U 2"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Nexus","Iphone 5"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Nexus","Iphone 5"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Nexus","Iphone 5"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Nexus","Iphone 5"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Nexus","Iphone 5"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.033-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for user: u-3

Query:

{
    "user": "u-3"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Surface"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Surface"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Surface"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Surface"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Surface"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.110-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for user: u-4

Query:

{
    "user": "u-4"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 5","Iphone 4"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.194-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for user: u5

Query:

{
    "user": "u5"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.265-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




============ simple similar item recs ============

Recommendations for item: Iphone 4

Query:

{
    "item": "Iphone 4"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.344-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for item: Ipad-retina

Query:

{
    "item": "Ipad-retina"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Iphone 4","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Ipad-retina"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Iphone 4","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Ipad-retina"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Iphone 4","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Ipad-retina"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Iphone 4","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Ipad-retina"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Iphone 4","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.382-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Ipad-retina"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for item: Nexus

Query:

{
    "item": "Nexus"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 5","Galaxy"]}},{"terms":{"view":["Tablets","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Nexus"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 5","Galaxy"]}},{"terms":{"view":["Tablets","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Nexus"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 5","Galaxy"]}},{"terms":{"view":["Tablets","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Nexus"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 5","Galaxy"]}},{"terms":{"view":["Tablets","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Nexus"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 5","Galaxy"]}},{"terms":{"view":["Tablets","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.428-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Nexus"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for item: Galaxy

Query:

{
    "item": "Galaxy"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Nexus","Iphone 5","Ipad-retina","Iphone 4"]}},{"terms":{"view":["Phones","Soap","Tablets"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Galaxy"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Nexus","Iphone 5","Ipad-retina","Iphone 4"]}},{"terms":{"view":["Phones","Soap","Tablets"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Galaxy"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Nexus","Iphone 5","Ipad-retina","Iphone 4"]}},{"terms":{"view":["Phones","Soap","Tablets"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Galaxy"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Nexus","Iphone 5","Ipad-retina","Iphone 4"]}},{"terms":{"view":["Phones","Soap","Tablets"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Galaxy"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":["Iphone 6","Nexus","Iphone 5","Ipad-retina","Iphone 4"]}},{"terms":{"view":["Phones","Soap","Tablets"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.471-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Galaxy"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for item: Surface

Query:

{
    "item": "Surface"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":[]}},{"terms":{"view":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Surface"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":[]}},{"terms":{"view":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Surface"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":[]}},{"terms":{"view":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Surface"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":[]}},{"terms":{"view":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Surface"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"purchase":[]}},{"terms":{"view":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.515-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Surface"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




============ popular item recs only ============

query with no item or user id, ordered by popularity

Query:

{
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.552-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for non-existant user: xyz, all from popularity

Query:

{
    "user": "xyz"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.596-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for non-existant item: xyz, all from popularity

Query:

{
    "item": "xyz"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["xyz"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["xyz"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["xyz"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["xyz"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.644-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["xyz"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for no user no item, all from popularity, Tablets filter

Query:

{
    "fields": [{
        "name": "categories",
        "values": ["Tablets"],
        "bias": -1
    }]
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"categories":["Tablets"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"categories":["Tablets"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"categories":["Tablets"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"categories":["Tablets"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"categories":["Tablets"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.687-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for no user no item, all from popularity, Tablets boost

Query:

{
    "fields": [{
        "name": "categories",
        "values": ["Tablets"],
        "bias": 1.05
    }]
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.728-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




Recommendations for no user no item, all from popularity, Tablets boost, Estados Unidos Mexicanos filter

Query:

{
    "fields": [{
        "name": "categories",
        "values": ["Tablets"],
        "bias": 1.05
    }, {
        "name": "countries",
        "values": ["Estados Unidos Mexicanos"],
        "bias": -1
    }]
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"countries":["Estados Unidos Mexicanos"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"countries":["Estados Unidos Mexicanos"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"countries":["Estados Unidos Mexicanos"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"countries":["Estados Unidos Mexicanos"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":[]}},{"terms":{"categories":["Tablets"]},"boost":1.05},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"terms":{"countries":["Estados Unidos Mexicanos"]},"boost":0},{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.770-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":[]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [_na] query malformed, must start with start_object]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)




============ dateRange filter ============

Recommendations for user: u1

Query:

{
    "user": "u1",
    "dateRange": {
        "name": "date",
        "before": "2017-05-06T19:44:31Z",
        "after": "2017-05-04T19:44:31Z"
    }
}

Stack Trace:
com.google.gson.JsonSyntaxException: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 6 column 20
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:176)
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.read(ReflectiveTypeAdapterFactory.java:93)
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:172)
	at com.google.gson.Gson.fromJson(Gson.java:803)
	at com.google.gson.Gson.fromJson(Gson.java:768)
	at com.google.gson.Gson.fromJson(Gson.java:717)
	at com.google.gson.Gson.fromJson(Gson.java:689)
	at org.apache.predictionio.workflow.JsonExtractor$.extractWithGson(JsonExtractor.scala:155)
	at org.apache.predictionio.workflow.JsonExtractor$.extract(JsonExtractor.scala:73)
	at org.apache.predictionio.workflow.ServerActor$$anonfun$24.apply(CreateServer.scala:507)
	at org.apache.predictionio.workflow.ServerActor$$anonfun$24.apply(CreateServer.scala:501)
	at spray.routing.ApplyConverterInstances$$anon$22$$anonfun$apply$1.apply(ApplyConverterInstances.scala:25)
	at spray.routing.ApplyConverterInstances$$anon$22$$anonfun$apply$1.apply(ApplyConverterInstances.scala:24)
	at spray.routing.ConjunctionMagnet$$anon$1$$anon$2$$anonfun$happly$1$$anonfun$apply$1.apply(Directive.scala:38)
	at spray.routing.ConjunctionMagnet$$anon$1$$anon$2$$anonfun$happly$1$$anonfun$apply$1.apply(Directive.scala:37)
	at spray.routing.directives.BasicDirectives$$anon$1.happly(BasicDirectives.scala:26)
	at spray.routing.ConjunctionMagnet$$anon$1$$anon$2$$anonfun$happly$1.apply(Directive.scala:37)
	at spray.routing.ConjunctionMagnet$$anon$1$$anon$2$$anonfun$happly$1.apply(Directive.scala:36)
	at spray.routing.directives.BasicDirectives$$anon$2.happly(BasicDirectives.scala:79)
	at spray.routing.Directive$$anon$7$$anonfun$happly$4.apply(Directive.scala:86)
	at spray.routing.Directive$$anon$7$$anonfun$happly$4.apply(Directive.scala:86)
	at spray.routing.directives.BasicDirectives$$anon$3$$anonfun$happly$1.apply(BasicDirectives.scala:92)
	at spray.routing.directives.BasicDirectives$$anon$3$$anonfun$happly$1.apply(BasicDirectives.scala:92)
	at spray.routing.directives.ExecutionDirectives$$anonfun$detach$1$$anonfun$apply$7$$anonfun$apply$3.apply$mcV$sp(ExecutionDirectives.scala:89)
	at spray.routing.directives.ExecutionDirectives$$anonfun$detach$1$$anonfun$apply$7$$anonfun$apply$3.apply(ExecutionDirectives.scala:89)
	at spray.routing.directives.ExecutionDirectives$$anonfun$detach$1$$anonfun$apply$7$$anonfun$apply$3.apply(ExecutionDirectives.scala:89)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.liftedTree1$1(Future.scala:24)
	at scala.concurrent.impl.Future$PromiseCompletingRunnable.run(Future.scala:24)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$3.exec(ExecutionContextImpl.scala:107)
	at scala.concurrent.forkjoin.ForkJoinTask.doExec(ForkJoinTask.java:260)
	at scala.concurrent.forkjoin.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1339)
	at scala.concurrent.forkjoin.ForkJoinPool.runWorker(ForkJoinPool.java:1979)
	at scala.concurrent.forkjoin.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:107)
Caused by: java.lang.IllegalStateException: Expected BEGIN_OBJECT but was STRING at line 6 column 20
	at com.google.gson.stream.JsonReader.beginObject(JsonReader.java:374)
	at com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.read(ReflectiveTypeAdapterFactory.java:165)
	... 34 more




============ query with item and user *EXPERIMENTAL* ============

Recommendations for no user no item, all from popularity, Tablets boost, Estados Unidos Mexicanos filter

Query:

{
    "user": "u1",
    "item": "Iphone 4"
}

Stack Trace:
org.elasticsearch.action.search.SearchPhaseExecutionException: Failed to execute phase [query], all shards failed; shardFailures {[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][0]: SearchParseException[[urindex_1494027837146][0]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][1]: SearchParseException[[urindex_1494027837146][1]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][2]: SearchParseException[[urindex_1494027837146][2]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][3]: SearchParseException[[urindex_1494027837146][3]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }{[D7FiPNLsSYiYjKQzpg3AMw][urindex_1494027837146][4]: SearchParseException[[urindex_1494027837146][4]: from[-1],size[20]: Parse Failure [Failed to parse source [{"size":20,"query":{"bool":{"should":[{"terms":{"purchase":["Galaxy","Iphone 6","Ipad-retina","Iphone 5","Iphone 4"]}},{"terms":{"purchase":["Iphone 6","Iphone 5","Ipad-retina","Galaxy"]}},{"terms":{"view":["Soap","Phones"]}},{"constant_score":{"filter":{"match_all":{}},"boost":0}}],"must":[{"constant_score":{"filter":{"range":{"available":{"lte":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}},{"constant_score":{"filter":{"range":{"expires":{"gt":"2017-05-05T19:44:31.853-04:00"}}},"boost":0}}],"must_not":{"ids":{"values":["Iphone 4"]},"boost":0},"minimum_should_match":1}},"sort":[{"_score":{"order":"desc"}},{"popRank":{"unmapped_type":"double","order":"desc"}}]}]]]; nested: QueryParsingException[[urindex_1494027837146] [bool] query does not support [must_not]]; }
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction.onFirstPhaseResult(TransportSearchTypeAction.java:233)
	at org.elasticsearch.action.search.type.TransportSearchTypeAction$BaseAsyncAction$1.onFailure(TransportSearchTypeAction.java:179)
	at org.elasticsearch.search.action.SearchServiceTransportAction$23.run(SearchServiceTransportAction.java:565)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)



